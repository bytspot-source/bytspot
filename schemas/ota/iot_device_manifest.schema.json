{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://bytspot.ai/schemas/ota/iot_device_manifest.schema.json",
  "title": "IoT Device Manifest",
  "type": "object",
  "required": ["device_id", "firmware_version", "content_version", "urls", "sha256", "size"],
  "properties": {
    "device_id": {"type": "string"},
    "firmware_version": {"type": "string"},
    "content_version": {"type": "string"},
    "urls": {
      "type": "object",
      "properties": {
        "firmware_full": {"type": "string", "format": "uri"},
        "firmware_delta_from": {"type": "string"},
        "firmware_delta_url": {"type": "string", "format": "uri"},
        "content_bundle": {"type": "string", "format": "uri"}
      },
      "required": ["firmware_full"]
    },
    "sha256": {"type": "string", "pattern": "^[a-fA-F0-9]{64}$"},
    "size": {"type": "integer", "minimum": 1},
    "config": {
      "type": "object",
      "properties": {
        "brightness": {"type": "integer", "minimum": 0, "maximum": 100},
        "wifi_ssid": {"type": "string"}
      }
    },
    "rollout_phase": {"type": "string", "enum": ["canary", "ramp", "full", "paused"]},
    "etag": {"type": "string"}
  }
}

